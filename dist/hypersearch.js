(function(a){typeof define=="function"&&define.amd?define(a):a()})(function(){"use strict";const a="data-hypersearch",h="data-hypersearch-start",o="data-hypersearch-end";function d(t,e){e.forEach(n=>n.updateVisibility(t))}function u(t){const n=m([...t.querySelectorAll(f(t))]).flatMap(c.make);return g(n),n}class c{constructor(e){this.domElement=e,this.ancestorHeadings=[],this.descendents=[],this._lastSearch=null,this._lastSearchMatched=!1,this._searchableText=e.innerText;const n=e.tagName.toLowerCase();this._inspectString=`${n} ${this.innerText()}`}static make(e){return e instanceof HTMLElement?[new c(e)]:[]}addAncestorHeading(e){this.ancestorHeadings.push(e),this._searchableText+=" "+e.innerText()}addDescendent(e){this.descendents.push(e)}updateVisibility(e){this.domElement.style.display=this.shouldBeVisible(e)?"":"none"}shouldBeVisible(e){return this.matches(e)||this.descendents.some(n=>n.matches(e))}matches(e){return e!==this._lastSearch&&(this._lastSearch=e,this._lastSearchMatched=e.matches(this.innerText())),this._lastSearchMatched}headingLevel(){switch(this.domElement.tagName){case"H2":return 0;case"H3":return 1;case"H4":return 2;case"H5":return 3;case"H6":return 4;default:return null}}inspect(){return this._inspectString}innerText(){return this._searchableText}}function f(t){const e="h2, h3, h4, h5, h6",n="p, blockquote, pre, hr",s="ul, ol",r=`[${h}]`,i=`[${o}]`;return t.querySelector(`${r}`)?`
      ${r},
      ${i},
      ${r} ~ :is(${n}, ${e}),
      ${r} ~ :is(${s}) > li
    `:`
      ${e},
      :is(${e}) ~ :is(${n}),
      :is(${e}) ~ :is(${s}) > li
    `}function m(t){const e=t.findIndex(n=>n.getAttribute(o)!=null);return t.slice(0,e!==-1?e:t.length)}function g(t){const e=[null,null,null,null,null],n=e.length;for(const s of t){const r=s.headingLevel();if(r!=null){e[r]=s;for(let i=r+1;i<n;i++)e[i]=null;for(let i=r-1;i>=0;i--){const l=e[i];l!=null&&(l.addDescendent(s),s.addAncestorHeading(l))}}else for(const i of e)i!=null&&(i.addDescendent(s),s.addAncestorHeading(i))}}function p(t){document.readyState!=="loading"?setTimeout(t,0):document.addEventListener("DOMContentLoaded",t)}class S{constructor(e){this.regexen=T(e.trim().toLowerCase()).split(/\s+/).map(n=>new RegExp("\\b"+n,"i"))}matches(e){const n=e.toLowerCase();return this.regexen.every(s=>n.match(s))}}function T(t){return t.replace(/[\^$\\.()*+|{}\[\]?]/g,"")}p($);function $(){const t=document.querySelector(`input[${a}]`);if(t==null)return;const e=u(document.body),n=()=>{const s=new S(t.value);d(s,e)};n(),t.addEventListener("input",n)}});
